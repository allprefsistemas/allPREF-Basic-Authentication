$(function(){"use strict";function e(e){var a=$.trim(e.val());return a?(e.closest(".form-group").hasClass("has-error")&&e.closest(".form-group").removeClass("has-error"),e.closest(".form-group").addClass("has-success"),!0):e.closest(".form-group").hasClass("has-error")?void 0:(e.closest(".form-group").addClass("has-error"),!1)}function a(e){var a=$.trim(e.val());return a.length<4?e.closest(".form-group").hasClass("has-error")?void 0:(e.closest(".form-group").addClass("has-error"),!1):(e.closest(".form-group").hasClass("has-error")&&e.closest(".form-group").removeClass("has-error"),e.closest(".form-group").addClass("has-success"),!0)}function s(e){if(e.files&&e.files[0]){var a=new FileReader;a.onload=function(e){v.attr("src",e.target.result)},a.readAsDataURL(e.files[0])}}function r(){Webcam.freeze(),D.hide(),W.show(),P.show()}function t(){Webcam.unfreeze(),D.show(),W.hide(),P.hide()}function o(){Webcam.snap(function(e){Webcam.on("uploadComplete",function(e,a){200===e?($("#profileAvatar").attr("src",l+"/imgs/avatar/"+a),$(".user-avatar").attr("src",l+"/imgs/avatar/"+a)):w.show(),D.show(),W.hide(),P.hide(),Webcam.reset(),C.modal("hide")});var a=n+"config/profile/avatar/";Webcam.upload(e,a)})}var i=$(".infosjs"),n=i.data("auth"),l=i.data("public"),c=$("#changeDetails"),d=$("#avatarDiv"),u=$("#changePasswordForm");if(c.length>0){var f=$("#inputName");c.submit(function(a){$(this).find("button").prop("disabled",!0),e(f)||(a.preventDefault(),$(this).find("button").prop("disabled",!1))})}if(d.length>0){var h=$("#fileModal"),p=$("#fileForm"),m=$("#inputFile"),v=$("#filePreview"),b=$("#inputFileErr"),g=$("#profileAvatar").data("src");m.uniform({fileButtonClass:"action btn btn-primary"}),m.change(function(){var e=m.val().split(".").pop().toLowerCase();$.inArray(e,["png","jpg","jpeg"])==-1||this.files[0].size>2097152?b.removeClass("hidden").addClass("show"):(b.removeClass("show").addClass("hidden"),s(this))}),h.on("show.bs.modal",function(){m.val(""),$.uniform.update(),v.attr("src",g)}),p.submit(function(a){$(this).find("button").prop("disabled",!0),e(m)||(a.preventDefault(),$(this).find("button").prop("disabled",!1))});var w=$("#avatarErro"),C=$("#webcamModal"),D=$("#webcamPreview"),W=$("#webcamCancelPreview"),P=$("#webcamSave");C.on("show.bs.modal",function(){w.hide(),W.hide(),P.hide(),D.show(),Webcam.set({width:320,height:240,dest_width:640,dest_height:480,image_format:"jpeg",jpeg_quality:100}),Webcam.attach("#webcamShow"),D.click(function(e){e.preventDefault(),r()}),W.click(function(e){e.preventDefault(),t()}),P.click(function(e){e.preventDefault(),o()})}),C.on("hide.bs.modal",function(){Webcam.reset()})}u.length>0&&u.submit(function(e){function s(){var e=a($("#password")),s=a($("#newPassword")),r=a($("#repeatPassword"));return e&&s&&r}$(this).find("button").prop("disabled",!0),s()||(e.preventDefault(),$(this).find("button").prop("disabled",!1))})});